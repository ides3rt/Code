#!/bin/sh

File="$HOME"/.local/share/dictionary

test -f "$File" || printf '' > "$File"

findword() {
	while read Curline; do
		printf '%s\n' "${CurLine% -*}"
	done < "$File"
	unset -v Curline
}

Word=$(findword | rofi -dmenu -i -p 'Word')

test -z "$Word" && exit 0

if test -z "$(grep -io "^$Word" $File)"; then

	Meaning=$(rofi -dmenu -p 'Meaning')
	test -z "$Meaning" && exit 0

	echo "$Word - $Meaning" >> "$File"
else
	grep -i "^$Word" "$File" | rofi -dmenu -i -p 'Matching'
fi
