#!/bin/sh

File="${XDG_DATA_DIR:-$HOME/.local/share}"/dictionary

test -f "$File" || printf '' > "$File"

findword() {
	while IFS=' - ' read Curline _; do
		printf '%s\n' "$Curline"
	done < "$File"
	unset -v Curline
}

Word=$(findword | rofi -dmenu -i -p 'Word')

test -z "$Word" && exit 0

List=$(grep -i ^"$Word" "$File")

if test -n "$List"; then
	printf '%s\n' "$List" | rofi -dmenu -i -p 'Matching'
else
	Meaning=$(rofi -dmenu -i -p 'Meaning')
	test -z "$Meaning" && exit 0
	printf '%s\n' "$Word - $Meaning" >> "$File"
fi
